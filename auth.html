<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Telegram Авторизация</title>
</head>
<body>
  <h2 style="text-align: center;">⏳ Завершаем авторизацию...</h2>

  <script>
    // Получаем параметры из строки запроса
    const params = new URLSearchParams(window.location.search);

    const user = {
      id: params.get('id'),
      first_name: params.get('first_name'),
      last_name: params.get('last_name'),
      username: params.get('username'),
      photo_url: params.get('photo_url'),
      auth_date: params.get('auth_date'),
      hash: params.get('hash')
    };

    // Проверка, что пришёл ID от Telegram
    if (user.id) {
      localStorage.setItem('telegram_user', JSON.stringify(user));
      if (window.opener) {
        window.opener.location.reload(); // Обновим родительское окно
        window.close(); // Закроем auth.html
      } else {
        window.location.href = "https://forbix7.github.io/TESTER/";
      }
    } else {
      document.body.innerHTML = "<h2 style='color:red; text-align:center;'>❌ Ошибка авторизации. Данные не получены.</h2>";
    }
  </script>
</body>
</html>
